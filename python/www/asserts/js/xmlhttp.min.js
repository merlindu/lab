/*!
 * XMLHttpRequest object pool
 * Copyright 2016-2018 ming.du@sunmedia.com.cn
 */
XMLHttp={XMLHttpRequestPool:[],getInstance:function(){for(var t=0;t<this.XMLHttpRequestPool.length;t++)if(0==this.XMLHttpRequestPool[t].readyState||4==this.XMLHttpRequestPool[t].readyState)return this.XMLHttpRequestPool[t];return this.XMLHttpRequestPool[this.XMLHttpRequestPool.length]=this.createXMLHttpRequest(),this.XMLHttpRequestPool[this.XMLHttpRequestPool.length-1]},createXMLHttpRequest:function(){if(window.XMLHttpRequest)n=new XMLHttpRequest;else for(var t=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{var n=new ActiveXObject(t[e]);break}catch(t){}return null==n.readyState&&(n.readyState=0,n.addEventListener("load",function(){n.readyState=4,"function"==typeof n.onreadystatechange&&n.onreadystatechange()},!1)),n},sendRequest:function(url,method,eventId,data,callback){var objXMLHttp=this.getInstance(),content="EventId="+eventId+"&"+data;with(method=method.toUpperCase(),objXMLHttp)try{url.indexOf("?")>0?url+="&randnum="+Math.random():url+="?randnum="+Math.random(),"GET"==method&&(url+="&"+content),open(method,url,!0),setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==method?send(content):"GET"==method&&send(null),onreadystatechange=function(){4!=objXMLHttp.readyState||200!=objXMLHttp.status&&304!=objXMLHttp.status||callback.call(null,objXMLHttp)}}catch(t){alert(t)}}};